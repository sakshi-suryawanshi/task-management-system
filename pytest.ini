# ============================================================================
# Pytest Configuration for Task Management System
# ============================================================================
# This file configures pytest for running Django tests.
# Pytest is a modern testing framework that provides better test discovery,
# fixtures, and plugins compared to Django's built-in test framework.
#
# Documentation: https://docs.pytest.org/en/stable/
# Pytest-Django: https://pytest-django.readthedocs.io/
# ============================================================================

[pytest]
# Django settings module
DJANGO_SETTINGS_MODULE = taskmanager.settings

# Python files and directories to search for tests
# Look for test files in any directory with these patterns
python_files = test_*.py *_test.py tests.py

# Python classes to collect tests from
python_classes = Test*

# Python functions to collect tests from
python_functions = test_*

# Test discovery patterns
# Only collect tests from test directories, not from migrations or other places
testpaths = 
    users
    teams
    projects
    tasks
    notifications
    core

# Add current directory to Python path for imports
pythonpath = .

# Command-line options
# Add command-line options for pytest
addopts = 
    --verbose
    --strict-markers
    --tb=short
    --durations=10
    --disable-warnings
    --color=yes
    --cov=.
    --cov-config=.coveragerc
    --cov-report=term-missing
    --cov-report=html
    --cov-report=xml
    --cov-fail-under=80
    --reuse-db
    --nomigrations

# Marker definitions for organizing tests
# Usage: @pytest.mark.unit, @pytest.mark.integration, etc.
markers =
    unit: Unit tests (fast, isolated tests)
    integration: Integration tests (test multiple components together)
    api: API endpoint tests
    model: Model tests
    view: View/ViewSet tests
    serializer: Serializer tests
    permission: Permission tests
    celery: Celery task tests
    slow: Slow running tests
    requires_db: Tests that require database access
    requires_redis: Tests that require Redis
    requires_celery: Tests that require Celery worker

# Logging configuration
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Pytest-cov configuration
# Coverage settings are configured here to ensure consistent coverage reporting
[coverage:run]
source = .
omit =
    */migrations/*
    */venv/*
    */env/*
    */__pycache__/*
    */tests/*
    */test_*.py
    manage.py
    */settings/*
    */wsgi.py
    */asgi.py
    */celery.py
    */admin.py

[coverage:report]
precision = 2
show_missing = true
skip_covered = false
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING:
    @abstractmethod

